# Прогнозирование оттока клиентов

## Описание проекта
Проект направлен на разработку модели для прогнозирования оттока клиентов на основе исторических данных. Целью является выявление клиентов, которые могут покинуть компанию, для принятия проактивных мер по их удержанию.

## Структура проекта
- `data_preprocessing.py` — скрипт для предобработки данных.
- `feature_engineering.py` — скрипт для создания и масштабирования признаков.
- `model_training.py` — скрипт для обучения модели.
- `model_evaluation.py` — скрипт для оценки и тестирования модели.
- `model_inference.py` — скрипт для предсказания оттока на новых данных.
- `data/` — папка с исходными и обработанными данными.
- `models/` — папка для сохранения обученной модели.

## Отчет по проекту

### 1. Цель проекта
Создание модели для прогнозирования вероятности оттока клиентов на основе исторических данных. Это позволит компании определить, какие клиенты могут уйти, и принять меры для их удержания.

### 2. Данные
Исходный набор данных содержит информацию о клиентах, включая такие признаки, как количество транзакций, длительность обслуживания, месячные затраты и общие расходы. Основной целевой переменной является столбец `Churn`, указывающий, покинул ли клиент компанию (1 — да, 0 — нет).

### 3. Предобработка данных
На этапе предобработки были выполнены следующие действия:
- Заполнение пропусков медианой для числовых признаков и forward/backward fill для остальных.
- Преобразование категориальных переменных в числовые с использованием one-hot encoding.
- Масштабирование числовых признаков с помощью `StandardScaler` для приведения их к одному диапазону.

### 4. Создание новых признаков (Feature Engineering)
Был создан дополнительный признак `TotalTransactions`, который является произведением количества транзакций (`NumTransactions`) и длительности обслуживания (`Tenure`). Это помогает модели лучше учитывать поведение клиента за время его обслуживания.

### 5. Обучение модели
В качестве модели выбрана **логистическая регрессия**. Эта модель была выбрана, так как она может эффективно работать даже на небольшом количестве данных и менее подвержена переобучению.

#### Гиперпараметрическая настройка
Для улучшения точности использовался `GridSearchCV` для подбора лучшего значения гиперпараметра `C`. Лучшая модель была сохранена в файл `models/churn_model.pkl`.

### 6. Оценка модели
Для оценки модели использовались метрики точности (accuracy) и отчёт по классификации. ROC-кривая также была построена для наглядной оценки качества модели.

**Результаты оценки:**
- Accuracy: 1.00
- ROC AUC: 1.00 (значение может варьироваться в зависимости от объема данных)

### 7. Выводы и рекомендации
Модель логистической регрессии показала высокую точность и предсказала отток клиентов с высокой степенью уверенности. Рекомендуется собрать больше данных для повышения надежности предсказаний и предотвращения возможного переобучения. Дополнительно можно рассмотреть возможность применения других алгоритмов, если объем данных увеличится.

## Установка

1. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
2. Предобработка данных:
   ```bash
   python data_preprocessing.py
   ```
3. Создание признаков:
   ```bash
   python feature_engineering.py
   ```
4. Обучение модели:
   ```bash
   python model_training.py
   ```
5. Оценка модели:
   ```bash
   python model_evaluation.py
   ```
6. Прогноз на новых данных:
   ```bash
   python model_inference.py
   ```

Этот `README.md` включает описание проекта, шаги выполнения и основные результаты. Он также предоставляет инструкции по установке и запуску кода, что делает его полезным и понятным для пользователей проекта.

   
   